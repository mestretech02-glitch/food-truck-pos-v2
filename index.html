<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Truck Manager Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
</head>
<body class="bg-gray-900 text-white">
    <!-- HEADER -->
    <header class="bg-gray-800 border-b-2 border-orange-500 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <h1 class="text-3xl font-bold text-orange-400">üçî Food Truck Manager</h1>
                <button id="menu-toggle" class="md:hidden bg-orange-500 px-4 py-2 rounded text-white font-bold">‚ò∞</button>
            </div>
            <nav id="nav-menu" class="hidden md:flex gap-2 mt-4 md:mt-0">
                <button onclick="irPara('dashboard')" class="nav-btn px-4 py-2 rounded hover:bg-orange-500 transition" data-tela="dashboard">üìä Dashboard</button>
                <button onclick="irPara('vendas')" class="nav-btn px-4 py-2 rounded hover:bg-orange-500 transition" data-tela="vendas">üõí Vendas</button>
                <button onclick="irPara('cozinha')" class="nav-btn px-4 py-2 rounded hover:bg-orange-500 transition" data-tela="cozinha">üë®‚Äçüç≥ Cozinha</button>
                <button onclick="irPara('produtos')" class="nav-btn px-4 py-2 rounded hover:bg-orange-500 transition" data-tela="produtos">üì¶ Produtos</button>
                <button onclick="irPara('estoque')" class="nav-btn px-4 py-2 rounded hover:bg-orange-500 transition" data-tela="estoque">üìã Estoque</button>
                <button onclick="irPara('relatorios')" class="nav-btn px-4 py-2 rounded hover:bg-orange-500 transition" data-tela="relatorios">üìà Relat√≥rios</button>
                <button onclick="irPara('config')" class="nav-btn px-4 py-2 rounded hover:bg-orange-500 transition" data-tela="config">‚öôÔ∏è Config</button>
            </nav>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="max-w-7xl mx-auto px-4 py-8">
        <!-- DASHBOARD -->
        <div id="dashboard" class="tela">
            <h2 class="text-3xl font-bold mb-6">Dashboard</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                <div class="bg-gray-800 p-6 rounded-lg border-l-4 border-green-500">
                    <p class="text-gray-400 text-sm">Faturamento</p>
                    <p class="text-3xl font-bold text-green-400" id="dash-faturamento">R$ 0.00</p>
                </div>
                <div class="bg-gray-800 p-6 rounded-lg border-l-4 border-blue-500">
                    <p class="text-gray-400 text-sm">Lucro</p>
                    <p class="text-3xl font-bold text-blue-400" id="dash-lucro">R$ 0.00</p>
                </div>
                <div class="bg-gray-800 p-6 rounded-lg border-l-4 border-red-500">
                    <p class="text-gray-400 text-sm">Despesas</p>
                    <p class="text-3xl font-bold text-red-400" id="dash-despesas">R$ 0.00</p>
                </div>
                <div class="bg-gray-800 p-6 rounded-lg border-l-4 border-yellow-500">
                    <p class="text-gray-400 text-sm">Pedidos</p>
                    <p class="text-3xl font-bold text-yellow-400" id="dash-pedidos">0</p>
                </div>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-gray-800 p-6 rounded-lg">
                    <h3 class="text-xl font-bold mb-4">Pedidos na Cozinha</h3>
                    <div id="dash-cozinha" class="space-y-2"></div>
                </div>
                <div class="bg-gray-800 p-6 rounded-lg">
                    <h3 class="text-xl font-bold mb-4">√öltimas Vendas</h3>
                    <div id="dash-vendas" class="space-y-2"></div>
                </div>
            </div>
        </div>

        <!-- VENDAS -->
        <div id="vendas" class="tela hidden">
            <h2 class="text-3xl font-bold mb-6">Nova Venda</h2>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- PRODUTOS -->
                <div class="lg:col-span-2">
                    <h3 class="text-xl font-bold mb-4">Produtos Dispon√≠veis</h3>
                    <div id="lista-produtos" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                </div>

                <!-- CARRINHO -->
                <div class="bg-gray-800 p-6 rounded-lg h-fit sticky top-24">
                    <h3 class="text-xl font-bold mb-4">üõí Carrinho</h3>
                    <div id="carrinho-itens" class="space-y-2 mb-4 max-h-64 overflow-y-auto"></div>
                    <div class="border-t border-gray-700 pt-4 mb-4">
                        <div class="flex justify-between mb-2">
                            <span>Subtotal:</span>
                            <span id="carrinho-subtotal">R$ 0.00</span>
                        </div>
                        <div class="flex justify-between text-lg font-bold text-green-400 mb-4">
                            <span>Total:</span>
                            <span id="carrinho-total">R$ 0.00</span>
                        </div>
                    </div>
                    <div class="space-y-2 mb-4">
                        <input type="text" id="cliente-nome" placeholder="Nome do cliente" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white">
                        <input type="tel" id="cliente-telefone" placeholder="Telefone" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white">
                        <select id="tipo-pedido" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white">
                            <option value="local">Local</option>
                            <option value="viagem">Viagem</option>
                        </select>
                    </div>
                    <button onclick="abrirPagamento()" class="w-full bg-green-600 hover:bg-green-700 px-4 py-3 rounded font-bold mb-2">‚úì Finalizar</button>
                    <button onclick="limparCarrinho()" class="w-full bg-red-600 hover:bg-red-700 px-4 py-3 rounded font-bold">üóëÔ∏è Limpar</button>
                </div>
            </div>
        </div>

        <!-- COZINHA -->
        <div id="cozinha" class="tela hidden">
            <h2 class="text-3xl font-bold mb-6">Cozinha</h2>
            <div id="cozinha-pedidos" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"></div>
        </div>

        <!-- PRODUTOS -->
        <div id="produtos" class="tela hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold">Produtos</h2>
                <button onclick="abrirModalProduto()" class="bg-orange-500 hover:bg-orange-600 px-6 py-2 rounded font-bold">+ Novo Produto</button>
            </div>
            <div id="tabela-produtos" class="bg-gray-800 rounded-lg overflow-x-auto"></div>
        </div>

        <!-- ESTOQUE -->
        <div id="estoque" class="tela hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold">Estoque</h2>
                <button onclick="abrirModalIngrediente()" class="bg-orange-500 hover:bg-orange-600 px-6 py-2 rounded font-bold">+ Novo Ingrediente</button>
            </div>
            <div id="tabela-estoque" class="bg-gray-800 rounded-lg overflow-x-auto"></div>
        </div>

        <!-- RELAT√ìRIOS -->
        <div id="relatorios" class="tela hidden">
            <h2 class="text-3xl font-bold mb-6">Relat√≥rios</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-gray-800 p-6 rounded-lg border-l-4 border-green-500">
                    <p class="text-gray-400 text-sm">Faturamento</p>
                    <p class="text-2xl font-bold text-green-400" id="rel-faturamento">R$ 0.00</p>
                </div>
                <div class="bg-gray-800 p-6 rounded-lg border-l-4 border-red-500">
                    <p class="text-gray-400 text-sm">Despesas</p>
                    <p class="text-2xl font-bold text-red-400" id="rel-despesas">R$ 0.00</p>
                </div>
                <div class="bg-gray-800 p-6 rounded-lg border-l-4 border-blue-500">
                    <p class="text-gray-400 text-sm">Lucro</p>
                    <p class="text-2xl font-bold text-blue-400" id="rel-lucro">R$ 0.00</p>
                </div>
                <div class="bg-gray-800 p-6 rounded-lg border-l-4 border-purple-500">
                    <p class="text-gray-400 text-sm">Margem</p>
                    <p class="text-2xl font-bold text-purple-400" id="rel-margem">0%</p>
                </div>
            </div>
            <button onclick="exportarPDF()" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded font-bold mb-6">üìÑ Exportar PDF</button>
        </div>

        <!-- CONFIGURA√á√ïES -->
        <div id="config" class="tela hidden">
            <h2 class="text-3xl font-bold mb-6">Configura√ß√µes</h2>
            <div class="bg-gray-800 p-6 rounded-lg max-w-2xl">
                <div class="space-y-4 mb-6">
                    <div>
                        <label class="block text-gray-400 mb-2">Taxa D√©bito (%)</label>
                        <input type="number" id="taxa-debito" step="0.01" value="1.5" class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white">
                    </div>
                    <div>
                        <label class="block text-gray-400 mb-2">Taxa Cr√©dito (%)</label>
                        <input type="number" id="taxa-credito" step="0.01" value="2.5" class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white">
                    </div>
                </div>
                <button onclick="salvarConfig()" class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded font-bold mr-2">üíæ Salvar</button>
                <button onclick="limparTudo()" class="bg-red-600 hover:bg-red-700 px-6 py-3 rounded font-bold">üóëÔ∏è Limpar Tudo</button>
            </div>
        </div>
    </main>

    <!-- MODAIS -->
    <!-- Modal Produto -->
    <div id="modal-produto" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto">
        <div class="bg-gray-800 p-8 rounded-lg max-w-2xl w-full my-8">
            <h2 class="text-2xl font-bold mb-6">Produto</h2>
            <div class="space-y-4 mb-6">
                <input type="text" id="prod-nome" placeholder="Nome do produto" class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white">
                <input type="number" id="prod-preco" placeholder="Pre√ßo de venda" step="0.01" class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white">
                <input type="text" id="prod-imagem" placeholder="URL da imagem" class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white">
            </div>
            <div class="flex gap-2">
                <button onclick="salvarProduto()" class="flex-1 bg-green-600 hover:bg-green-700 px-4 py-2 rounded font-bold">‚úì Salvar</button>
                <button onclick="fecharModalProduto()" class="flex-1 bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded">‚úï Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal Ingrediente -->
    <div id="modal-ingrediente" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-gray-800 p-8 rounded-lg max-w-md w-full">
            <h2 class="text-2xl font-bold mb-6">Ingrediente</h2>
            <div class="space-y-4 mb-6">
                <input type="text" id="ing-nome" placeholder="Nome" class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white">
                <input type="number" id="ing-estoque" placeholder="Quantidade" step="0.01" class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white">
                <select id="ing-unidade" class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white">
                    <option value="un">Unidades</option>
                    <option value="g">Gramas</option>
                    <option value="kg">Quilogramas</option>
                    <option value="ml">Mililitros</option>
                    <option value="l">Litros</option>
                </select>
                <input type="number" id="ing-preco" placeholder="Pre√ßo unit√°rio" step="0.01" class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white">
            </div>
            <div class="flex gap-2">
                <button onclick="salvarIngrediente()" class="flex-1 bg-green-600 hover:bg-green-700 px-4 py-2 rounded font-bold">‚úì Salvar</button>
                <button onclick="fecharModalIngrediente()" class="flex-1 bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded">‚úï Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal Pagamento -->
    <div id="modal-pagamento" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-gray-800 p-8 rounded-lg max-w-md w-full">
            <h2 class="text-2xl font-bold mb-6">M√©todo de Pagamento</h2>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <button onclick="finalizarVenda('dinheiro')" class="bg-green-600 hover:bg-green-700 px-4 py-3 rounded font-bold">üíµ Dinheiro</button>
                <button onclick="finalizarVenda('debito')" class="bg-blue-600 hover:bg-blue-700 px-4 py-3 rounded font-bold">üèß D√©bito</button>
                <button onclick="finalizarVenda('credito')" class="bg-purple-600 hover:bg-purple-700 px-4 py-3 rounded font-bold">üí≥ Cr√©dito</button>
                <button onclick="finalizarVenda('pix')" class="bg-orange-600 hover:bg-orange-700 px-4 py-3 rounded font-bold">üì± PIX</button>
            </div>
            <button onclick="fecharPagamento()" class="w-full bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded">‚úï Cancelar</button>
        </div>
    </div>

    <!-- Modal Sucesso -->
    <div id="modal-sucesso" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-gray-800 p-8 rounded-lg max-w-md w-full text-center">
            <h2 class="text-3xl font-bold mb-4 text-green-400">‚úì Venda Realizada!</h2>
            <p class="text-gray-400 mb-2">Pedido #</p>
            <p class="text-5xl font-bold text-orange-400 mb-6" id="numero-pedido">0</p>
            <button onclick="fecharSucesso()" class="w-full bg-orange-500 hover:bg-orange-600 px-4 py-3 rounded font-bold">OK</button>
        </div>
    </div>

    <script>
        // ===== DADOS =====
        let app = {
            produtos: [],
            ingredientes: [],
            vendas: [],
            carrinho: [],
            config: { taxaDebito: 1.5, taxaCredito: 2.5 },
            proximoId: 1
        };

        // Carregar dados
        function carregarDados() {
            const dados = localStorage.getItem('foodTruck');
            if (dados) {
                app = JSON.parse(dados);
            } else {
                app.produtos = [
                    { id: 1, nome: 'Hamburguer Cl√°ssico', preco: 25.00, imagem: 'https://via.placeholder.com/200?text=Hamburguer' },
                    { id: 2, nome: 'Hamburguer Especial', preco: 35.00, imagem: 'https://via.placeholder.com/200?text=Especial' }
                ];
                app.ingredientes = [
                    { id: 1, nome: 'P√£o', estoque: 100, unidade: 'un', preco: 0.50 },
                    { id: 2, nome: 'Carne', estoque: 5000, unidade: 'g', preco: 0.03 }
                ];
                app.proximoId = 3;
                salvarDados();
            }
        }

        function salvarDados() {
            localStorage.setItem('foodTruck', JSON.stringify(app));
        }

        // ===== NAVEGA√á√ÉO =====
        function irPara(tela) {
            document.querySelectorAll('.tela').forEach(t => t.classList.add('hidden'));
            document.getElementById(tela).classList.remove('hidden');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('bg-orange-500'));
            document.querySelector(`[data-tela="${tela}"]`)?.classList.add('bg-orange-500');
            
            if (tela === 'dashboard') renderDashboard();
            else if (tela === 'vendas') renderVendas();
            else if (tela === 'cozinha') renderCozinha();
            else if (tela === 'produtos') renderProdutos();
            else if (tela === 'estoque') renderEstoque();
            else if (tela === 'relatorios') renderRelatorios();
        }

        document.getElementById('menu-toggle').addEventListener('click', () => {
            document.getElementById('nav-menu').classList.toggle('hidden');
        });

        // ===== DASHBOARD =====
        function renderDashboard() {
            const hoje = new Date().toDateString();
            const vendasHoje = app.vendas.filter(v => new Date(v.data).toDateString() === hoje);
            
            const faturamento = vendasHoje.reduce((sum, v) => sum + v.total, 0);
            const despesas = vendasHoje.reduce((sum, v) => sum + (v.taxa || 0), 0);
            const lucro = faturamento - despesas;

            document.getElementById('dash-faturamento').textContent = `R$ ${faturamento.toFixed(2)}`;
            document.getElementById('dash-lucro').textContent = `R$ ${lucro.toFixed(2)}`;
            document.getElementById('dash-despesas').textContent = `R$ ${despesas.toFixed(2)}`;
            document.getElementById('dash-pedidos').textContent = vendasHoje.length;

            document.getElementById('dash-cozinha').innerHTML = app.vendas
                .filter(v => v.status === 'pendente')
                .slice(-5)
                .map(v => `<div class="bg-yellow-900 p-3 rounded">Pedido #${v.id} - ${v.cliente}</div>`)
                .join('') || '<p class="text-gray-500">Nenhum pedido</p>';

            document.getElementById('dash-vendas').innerHTML = vendasHoje
                .slice(-5)
                .map(v => `<div class="bg-green-900 p-3 rounded">Pedido #${v.id} - R$ ${v.total.toFixed(2)}</div>`)
                .join('') || '<p class="text-gray-500">Nenhuma venda</p>';
        }

        // ===== VENDAS =====
        function renderVendas() {
            document.getElementById('lista-produtos').innerHTML = app.produtos.map(p => `
                <div onclick="adicionarCarrinho(${p.id}, '${p.nome}', ${p.preco})" class="bg-gray-800 rounded-lg overflow-hidden cursor-pointer hover:ring-2 hover:ring-orange-500 transition">
                    <img src="${p.imagem}" alt="${p.nome}" class="w-full h-40 object-cover">
                    <div class="p-4">
                        <h3 class="font-bold mb-2">${p.nome}</h3>
                        <p class="text-green-400 font-bold">R$ ${p.preco.toFixed(2)}</p>
                    </div>
                </div>
            `).join('');
            atualizarCarrinho();
        }

        function adicionarCarrinho(id, nome, preco) {
            const item = app.carrinho.find(i => i.id === id);
            if (item) {
                item.qtd++;
            } else {
                app.carrinho.push({ id, nome, preco, qtd: 1 });
            }
            atualizarCarrinho();
        }

        function atualizarCarrinho() {
            document.getElementById('carrinho-itens').innerHTML = app.carrinho.map((item, idx) => `
                <div class="bg-gray-700 p-3 rounded flex justify-between items-center">
                    <div>
                        <p class="font-bold">${item.nome}</p>
                        <p class="text-sm text-gray-400">R$ ${item.preco.toFixed(2)}</p>
                    </div>
                    <div class="flex items-center gap-2">
                        <input type="number" value="${item.qtd}" min="1" onchange="alterarQtd(${idx}, this.value)" class="w-12 bg-gray-600 rounded px-2 py-1 text-center text-white">
                        <button onclick="removerCarrinho(${idx})" class="bg-red-600 px-2 py-1 rounded text-sm">‚úï</button>
                    </div>
                </div>
            `).join('');

            const subtotal = app.carrinho.reduce((sum, item) => sum + (item.preco * item.qtd), 0);
            document.getElementById('carrinho-subtotal').textContent = `R$ ${subtotal.toFixed(2)}`;
            document.getElementById('carrinho-total').textContent = `R$ ${subtotal.toFixed(2)}`;
        }

        function alterarQtd(idx, qtd) {
            const q = parseInt(qtd) || 1;
            if (q > 0) app.carrinho[idx].qtd = q;
            else app.carrinho.splice(idx, 1);
            atualizarCarrinho();
        }

        function removerCarrinho(idx) {
            app.carrinho.splice(idx, 1);
            atualizarCarrinho();
        }

        function limparCarrinho() {
            app.carrinho = [];
            atualizarCarrinho();
        }

        function abrirPagamento() {
            if (app.carrinho.length === 0) {
                alert('Carrinho vazio!');
                return;
            }
            document.getElementById('modal-pagamento').classList.remove('hidden');
        }

        function fecharPagamento() {
            document.getElementById('modal-pagamento').classList.add('hidden');
        }

        function finalizarVenda(metodo) {
            const cliente = document.getElementById('cliente-nome').value || 'An√¥nimo';
            const tipo = document.getElementById('tipo-pedido').value;
            const total = app.carrinho.reduce((sum, item) => sum + (item.preco * item.qtd), 0);
            
            let taxa = 0;
            if (metodo === 'debito') taxa = total * (app.config.taxaDebito / 100);
            else if (metodo === 'credito') taxa = total * (app.config.taxaCredito / 100);

            const venda = {
                id: app.proximoId++,
                cliente,
                itens: [...app.carrinho],
                total,
                taxa,
                metodo,
                tipo,
                status: 'pendente',
                data: new Date().toISOString()
            };

            app.vendas.push(venda);
            salvarDados();

            document.getElementById('numero-pedido').textContent = venda.id;
            document.getElementById('modal-pagamento').classList.add('hidden');
            document.getElementById('modal-sucesso').classList.remove('hidden');

            app.carrinho = [];
            document.getElementById('cliente-nome').value = '';
            document.getElementById('cliente-telefone').value = '';
            atualizarCarrinho();
        }

        function fecharSucesso() {
            document.getElementById('modal-sucesso').classList.add('hidden');
            renderVendas();
        }

        // ===== COZINHA =====
        function renderCozinha() {
            document.getElementById('cozinha-pedidos').innerHTML = app.vendas
                .filter(v => v.status === 'pendente')
                .map(v => {
                    const tempo = Math.floor((Date.now() - new Date(v.data).getTime()) / 1000);
                    const min = Math.floor(tempo / 60);
                    const seg = tempo % 60;
                    return `
                        <div class="bg-gray-800 p-6 rounded-lg border-2 border-yellow-500">
                            <div class="flex justify-between items-center mb-4">
                                <p class="text-2xl font-bold text-orange-400">#${v.id}</p>
                                <p class="text-2xl font-bold text-yellow-400">${min}:${seg.toString().padStart(2, '0')}</p>
                            </div>
                            <p class="font-bold mb-3">${v.cliente}</p>
                            <div class="bg-gray-900 p-3 rounded mb-4 max-h-32 overflow-y-auto">
                                ${v.itens.map(i => `<p class="text-sm">‚Ä¢ ${i.qtd}x ${i.nome}</p>`).join('')}
                            </div>
                            <button onclick="marcarPronto(${v.id})" class="w-full bg-green-600 hover:bg-green-700 px-4 py-2 rounded font-bold">‚úì PRONTO</button>
                        </div>
                    `;
                }).join('') || '<p class="text-gray-500 col-span-full">Nenhum pedido pendente</p>';
        }

        function marcarPronto(id) {
            const venda = app.vendas.find(v => v.id === id);
            if (venda) {
                venda.status = 'pronto';
                salvarDados();
                renderCozinha();
            }
        }

        // ===== PRODUTOS =====
        function renderProdutos() {
            document.getElementById('tabela-produtos').innerHTML = `
                <table class="w-full">
                    <thead class="bg-gray-700">
                        <tr>
                            <th class="px-4 py-2 text-left">Nome</th>
                            <th class="px-4 py-2 text-left">Pre√ßo</th>
                            <th class="px-4 py-2 text-left">A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${app.produtos.map(p => `
                            <tr class="border-t border-gray-700">
                                <td class="px-4 py-2">${p.nome}</td>
                                <td class="px-4 py-2">R$ ${p.preco.toFixed(2)}</td>
                                <td class="px-4 py-2">
                                    <button onclick="excluirProduto(${p.id})" class="bg-red-600 hover:bg-red-700 px-3 py-1 rounded text-sm">Excluir</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function abrirModalProduto() {
            document.getElementById('prod-nome').value = '';
            document.getElementById('prod-preco').value = '';
            document.getElementById('prod-imagem').value = '';
            document.getElementById('modal-produto').classList.remove('hidden');
        }

        function fecharModalProduto() {
            document.getElementById('modal-produto').classList.add('hidden');
        }

        function salvarProduto() {
            const nome = document.getElementById('prod-nome').value;
            const preco = parseFloat(document.getElementById('prod-preco').value) || 0;
            const imagem = document.getElementById('prod-imagem').value || 'https://via.placeholder.com/200';

            if (!nome || preco <= 0) {
                alert('Preencha os campos corretamente!');
                return;
            }

            app.produtos.push({
                id: app.proximoId++,
                nome,
                preco,
                imagem
            });

            salvarDados();
            fecharModalProduto();
            renderProdutos();
            renderVendas();
        }

        function excluirProduto(id) {
            if (confirm('Tem certeza?')) {
                app.produtos = app.produtos.filter(p => p.id !== id);
                salvarDados();
                renderProdutos();
                renderVendas();
            }
        }

        // ===== ESTOQUE =====
        function renderEstoque() {
            document.getElementById('tabela-estoque').innerHTML = `
                <table class="w-full">
                    <thead class="bg-gray-700">
                        <tr>
                            <th class="px-4 py-2 text-left">Nome</th>
                            <th class="px-4 py-2 text-left">Estoque</th>
                            <th class="px-4 py-2 text-left">Pre√ßo Unit.</th>
                            <th class="px-4 py-2 text-left">A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${app.ingredientes.map(i => `
                            <tr class="border-t border-gray-700">
                                <td class="px-4 py-2">${i.nome}</td>
                                <td class="px-4 py-2">${i.estoque} ${i.unidade}</td>
                                <td class="px-4 py-2">R$ ${i.preco.toFixed(2)}</td>
                                <td class="px-4 py-2">
                                    <button onclick="excluirIngrediente(${i.id})" class="bg-red-600 hover:bg-red-700 px-3 py-1 rounded text-sm">Excluir</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function abrirModalIngrediente() {
            document.getElementById('ing-nome').value = '';
            document.getElementById('ing-estoque').value = '';
            document.getElementById('ing-preco').value = '';
            document.getElementById('modal-ingrediente').classList.remove('hidden');
        }

        function fecharModalIngrediente() {
            document.getElementById('modal-ingrediente').classList.add('hidden');
        }

        function salvarIngrediente() {
            const nome = document.getElementById('ing-nome').value;
            const estoque = parseFloat(document.getElementById('ing-estoque').value) || 0;
            const unidade = document.getElementById('ing-unidade').value;
            const preco = parseFloat(document.getElementById('ing-preco').value) || 0;

            if (!nome || estoque < 0 || preco < 0) {
                alert('Preencha os campos corretamente!');
                return;
            }

            app.ingredientes.push({
                id: app.proximoId++,
                nome,
                estoque,
                unidade,
                preco
            });

            salvarDados();
            fecharModalIngrediente();
            renderEstoque();
        }

        function excluirIngrediente(id) {
            if (confirm('Tem certeza?')) {
                app.ingredientes = app.ingredientes.filter(i => i.id !== id);
                salvarDados();
                renderEstoque();
            }
        }

        // ===== RELAT√ìRIOS =====
        function renderRelatorios() {
            const faturamento = app.vendas.reduce((sum, v) => sum + v.total, 0);
            const despesas = app.vendas.reduce((sum, v) => sum + (v.taxa || 0), 0);
            const lucro = faturamento - despesas;
            const margem = faturamento > 0 ? ((lucro / faturamento) * 100).toFixed(1) : 0;

            document.getElementById('rel-faturamento').textContent = `R$ ${faturamento.toFixed(2)}`;
            document.getElementById('rel-despesas').textContent = `R$ ${despesas.toFixed(2)}`;
            document.getElementById('rel-lucro').textContent = `R$ ${lucro.toFixed(2)}`;
            document.getElementById('rel-margem').textContent = `${margem}%`;
        }

        function exportarPDF() {
            const doc = new jsPDF();
            doc.setFontSize(16);
            doc.text('Relat√≥rio Food Truck Manager', 10, 10);
            doc.setFontSize(10);
            doc.text(`Data: ${new Date().toLocaleDateString()}`, 10, 20);

            const dados = app.vendas.map(v => [
                `#${v.id}`,
                v.cliente,
                `R$ ${v.total.toFixed(2)}`,
                v.metodo,
                v.status
            ]);

            doc.autoTable({
                head: [['Pedido', 'Cliente', 'Valor', 'Pagamento', 'Status']],
                body: dados,
                startY: 30
            });

            doc.save('relatorio_food_truck.pdf');
        }

        // ===== CONFIG =====
        function salvarConfig() {
            app.config.taxaDebito = parseFloat(document.getElementById('taxa-debito').value) || 0;
            app.config.taxaCredito = parseFloat(document.getElementById('taxa-credito').value) || 0;
            salvarDados();
            alert('Configura√ß√µes salvas!');
        }

        function limparTudo() {
            if (confirm('‚ö†Ô∏è Tem certeza? Isso vai deletar TUDO!')) {
                if (confirm('Tem CERTEZA MESMO?')) {
                    localStorage.removeItem('foodTruck');
                    location.reload();
                }
            }
        }

        // Inicializar
        carregarDados();
        irPara('dashboard');
    </script>
</body>
</html>
