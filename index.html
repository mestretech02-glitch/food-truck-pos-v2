<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Truck Manager Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0f172a; color: #e2e8f0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .navbar { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border-bottom: 3px solid #f97316; padding: 1rem; display: flex; align-items: center; gap: 2rem; }
        .logo { font-size: 1.5rem; font-weight: bold; color: #f97316; }
        .nav-tabs { display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .nav-btn { padding: 0.5rem 1rem; border: none; background: #334155; color: #e2e8f0; cursor: pointer; border-radius: 0.5rem; transition: all 0.3s; }
        .nav-btn.active { background: #f97316; color: #000; font-weight: bold; }
        .nav-btn:hover { background: #475569; }
        .container { padding: 2rem; max-width: 1400px; margin: 0 auto; }
        .section { display: none; }
        .section.active { display: block; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; }
        .card { background: #1e293b; border: 2px solid #334155; border-radius: 0.75rem; padding: 1.5rem; }
        .card.active { border-color: #f97316; }
        .product-card { cursor: pointer; transition: all 0.3s; border: 2px solid #334155; }
        .product-card:hover { border-color: #f97316; transform: translateY(-5px); }
        .product-card.pending { border-left: 5px solid #f97316; }
        .product-card.ready { border-left: 5px solid #22c55e; }
        .product-card.delayed { border-left: 5px solid #ef4444; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: bold; transition: all 0.3s; }
        .btn-primary { background: #f97316; color: #000; }
        .btn-primary:hover { background: #ea580c; }
        .btn-success { background: #22c55e; color: #000; }
        .btn-success:hover { background: #16a34a; }
        .btn-danger { background: #ef4444; color: #fff; }
        .btn-danger:hover { background: #dc2626; }
        .btn-secondary { background: #475569; color: #e2e8f0; }
        .btn-secondary:hover { background: #64748b; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
        .modal-content { background: #1e293b; border: 2px solid #f97316; border-radius: 0.75rem; padding: 2rem; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; }
        .modal-header { font-size: 1.5rem; font-weight: bold; color: #f97316; margin-bottom: 1.5rem; }
        .form-group { margin-bottom: 1.5rem; }
        .form-label { display: block; margin-bottom: 0.5rem; color: #cbd5e1; font-weight: bold; }
        .form-input, .form-textarea { width: 100%; padding: 0.75rem; background: #0f172a; border: 2px solid #334155; border-radius: 0.5rem; color: #e2e8f0; font-family: inherit; }
        .form-input:focus, .form-textarea:focus { outline: none; border-color: #f97316; }
        .checkbox-group { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; }
        .checkbox-item { display: flex; align-items: center; gap: 0.5rem; }
        .checkbox-item input { cursor: pointer; }
        .checkbox-item label { cursor: pointer; }
        .badge { display: inline-block; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.875rem; font-weight: bold; }
        .badge-orange { background: #f97316; color: #000; }
        .badge-green { background: #22c55e; color: #000; }
        .badge-red { background: #ef4444; color: #fff; }
        .badge-blue { background: #3b82f6; color: #fff; }
        .timer { font-size: 1.25rem; font-weight: bold; color: #f97316; }
        .timer.warning { color: #eab308; }
        .timer.danger { color: #ef4444; }
        .summary-card { background: linear-gradient(135deg, #334155 0%, #1e293b 100%); border-left: 5px solid #f97316; padding: 1.5rem; border-radius: 0.5rem; }
        .summary-value { font-size: 2rem; font-weight: bold; color: #f97316; }
        .summary-label { color: #94a3b8; font-size: 0.875rem; }
        .additional-tag { display: inline-block; background: #eab308; color: #000; padding: 0.25rem 0.75rem; border-radius: 0.25rem; margin-right: 0.5rem; font-size: 0.875rem; font-weight: bold; }
        .table { width: 100%; border-collapse: collapse; }
        .table th { background: #334155; padding: 1rem; text-align: left; border-bottom: 2px solid #f97316; }
        .table td { padding: 1rem; border-bottom: 1px solid #334155; }
        .table tr:hover { background: #1e293b; }
        @media (max-width: 768px) {
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
            .nav-tabs { flex-direction: column; }
            .nav-btn { width: 100%; }
        }
    </style>
</head>
<body>
    <!-- NAVBAR -->
    <div class="navbar">
        <div class="logo">üçî Food Truck Manager</div>
        <div class="nav-tabs">
            <button class="nav-btn active" onclick="mostrarSecao('dashboard')">üìä Dashboard</button>
            <button class="nav-btn" onclick="mostrarSecao('vendas')">üõí Vendas</button>
            <button class="nav-btn" onclick="mostrarSecao('cozinha')">üë®‚Äçüç≥ Cozinha</button>
            <button class="nav-btn" onclick="mostrarSecao('clientes')">üë• Clientes</button>
            <button class="nav-btn" onclick="mostrarSecao('produtos')">üì¶ Produtos</button>
            <button class="nav-btn" onclick="mostrarSecao('combos')">üéÅ Combos</button>
            <button class="nav-btn" onclick="mostrarSecao('estoque')">üìã Estoque</button>
            <button class="nav-btn" onclick="mostrarSecao('despesas')">üí∏ Despesas</button>
            <button class="nav-btn" onclick="mostrarSecao('relatorios')">üìä Relat√≥rios</button>
            <button class="nav-btn" onclick="mostrarSecao('config')">‚öôÔ∏è Config</button>
        </div>
    </div>

    <div class="container">
        <!-- DASHBOARD -->
        <div id="dashboard" class="section active">
            <h1 style="font-size: 2rem; margin-bottom: 2rem; color: #f97316;">üìä Dashboard</h1>
            
            <div class="grid-3" style="margin-bottom: 2rem;">
                <div class="summary-card">
                    <div class="summary-label">Faturamento Bruto</div>
                    <div class="summary-value" id="faturamento">R$ 0,00</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">Lucro L√≠quido</div>
                    <div class="summary-value" id="lucro">R$ 0,00</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">Pedidos Hoje</div>
                    <div class="summary-value" id="pedidosHoje">0</div>
                </div>
            </div>

            <h2 style="font-size: 1.5rem; margin: 2rem 0 1rem; color: #f97316;">üçΩÔ∏è Pedidos Para Entrega</h2>
            <div id="dashboardEntrega" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                <p style="color: #94a3b8;">Nenhum pedido pronto para entrega</p>
            </div>

            <h2 style="font-size: 1.5rem; margin: 2rem 0 1rem; color: #f97316;">üìã Hist√≥rico de Vendas (Hoje)</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Cliente</th>
                        <th>Produtos</th>
                        <th>Total</th>
                        <th>M√©todo</th>
                        <th>Hora</th>
                    </tr>
                </thead>
                <tbody id="dashboardHistorico">
                    <tr><td colspan="6" style="text-align: center; color: #94a3b8;">Nenhuma venda realizada</td></tr>
                </tbody>
            </table>
        </div>

        <!-- VENDAS -->
        <div id="vendas" class="section">
            <h1 style="font-size: 2rem; margin-bottom: 2rem; color: #f97316;">üõí Vendas</h1>
            
            <div style="display: flex; gap: 1rem; margin-bottom: 2rem;">
                <button class="nav-btn active" onclick="mostrarSubSecao('vendas', 'novaVenda')">Nova Venda</button>
                <button class="nav-btn" onclick="mostrarSubSecao('vendas', 'historicoVendas')">Hist√≥rico de Vendas</button>
            </div>

            <!-- NOVA VENDA -->
            <div id="novaVenda" class="section active">
                <div class="grid-2">
                    <!-- PRODUTOS -->
                    <div>
                        <h2 style="margin-bottom: 1.5rem; color: #f97316;">Produtos</h2>
                        <div id="gridProdutos" style="display: grid; grid-template-columns: 1fr; gap: 1rem;">
                            <!-- Preenchido por JS -->
                        </div>
                    </div>

                    <!-- CARRINHO -->
                    <div class="card">
                        <h2 style="margin-bottom: 1.5rem; color: #f97316;">üõí Carrinho de Compras</h2>
                        
                        <div class="form-group">
                            <label class="form-label">Tipo de Pedido</label>
                            <div style="display: flex; gap: 1rem;">
                                <button class="btn btn-primary" onclick="app.vendas.tipoPedido='Local'; atualizarCarrinho()">Local</button>
                                <button class="btn btn-secondary" onclick="app.vendas.tipoPedido='Para Viagem'; atualizarCarrinho()">Para Viagem</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Origem</label>
                            <div style="display: flex; gap: 1rem;">
                                <button class="btn btn-primary" onclick="app.vendas.origem='Venda Local'; atualizarCarrinho()">Venda Local</button>
                                <button class="btn btn-secondary" onclick="app.vendas.origem='iFood'; atualizarCarrinho()">iFood</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Nome do Cliente</label>
                            <input type="text" class="form-input" id="nomeCliente" placeholder="Buscar ou Adicionar Cliente" onchange="app.vendas.cliente = this.value">
                        </div>

                        <div class="form-group">
                            <label class="form-label">WhatsApp</label>
                            <input type="text" class="form-input" id="whatsapp" placeholder="Opcional" onchange="app.vendas.whatsapp = this.value">
                        </div>

                        <div style="background: #0f172a; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                            <div id="itensCarrinho">
                                <p style="color: #94a3b8;">Carrinho vazio</p>
                            </div>
                        </div>

                        <div style="background: #334155; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span>Subtotal:</span>
                                <span id="subtotal">R$ 0,00</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span>Taxa:</span>
                                <span id="taxa">R$ 0,00</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; font-size: 1.5rem; font-weight: bold; color: #22c55e;">
                                <span>Total:</span>
                                <span id="totalCarrinho">R$ 0,00</span>
                            </div>
                        </div>

                        <button class="btn btn-success" onclick="finalizarVenda()" style="width: 100%; padding: 1rem;">‚úì Finalizar Venda</button>
                    </div>
                </div>
            </div>

            <!-- HIST√ìRICO DE VENDAS -->
            <div id="historicoVendas" class="section">
                <table class="table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Cliente</th>
                            <th>Produtos</th>
                            <th>Total</th>
                            <th>M√©todo</th>
                            <th>Status</th>
                            <th>Hora</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaHistoricoVendas">
                        <tr><td colspan="7" style="text-align: center; color: #94a3b8;">Nenhuma venda realizada</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- COZINHA -->
        <div id="cozinha" class="section">
            <h1 style="font-size: 2rem; margin-bottom: 2rem; color: #f97316;">üë®‚Äçüç≥ Pedidos na Cozinha</h1>
            <div style="margin-bottom: 1rem; color: #94a3b8;">Pendentes: <span id="contadorPendentes">0</span></div>
            <div id="gridCozinha" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem;">
                <p style="color: #94a3b8;">Nenhum pedido pendente</p>
            </div>
        </div>

        <!-- CLIENTES -->
        <div id="clientes" class="section">
            <h1 style="font-size: 2rem; margin-bottom: 2rem; color: #f97316;">üë• Clientes</h1>
            <button class="btn btn-primary" onclick="abrirModal('modalCliente')" style="margin-bottom: 1.5rem;">+ Novo Cliente</button>
            <table class="table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>WhatsApp</th>
                        <th>Compras</th>
                        <th>Total Gasto</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="tabelaClientes">
                    <tr><td colspan="5" style="text-align: center; color: #94a3b8;">Nenhum cliente cadastrado</td></tr>
                </tbody>
            </table>
        </div>

        <!-- PRODUTOS -->
        <div id="produtos" class="section">
            <h1 style="font-size: 2rem; margin-bottom: 2rem; color: #f97316;">üì¶ Produtos</h1>
            <button class="btn btn-primary" onclick="abrirModal('modalProduto')" style="margin-bottom: 1.5rem;">+ Novo Produto</button>
            <table class="table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Pre√ßo</th>
                        <th>Custo</th>
                        <th>Lucro</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="tabelaProdutos">
                    <tr><td colspan="5" style="text-align: center; color: #94a3b8;">Nenhum produto cadastrado</td></tr>
                </tbody>
            </table>
        </div>

        <!-- COMBOS -->
        <div id="combos" class="section">
            <h1 style="font-size: 2rem; margin-bottom: 2rem; color: #f97316;">üéÅ Combos</h1>
            <button class="btn btn-primary" onclick="abrirModal('modalCombo')" style="margin-bottom: 1.5rem;">+ Novo Combo</button>
            <table class="table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Produtos</th>
                        <th>Pre√ßo</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="tabelaCombos">
                    <tr><td colspan="4" style="text-align: center; color: #94a3b8;">Nenhum combo cadastrado</td></tr>
                </tbody>
            </table>
        </div>

        <!-- ESTOQUE -->
        <div id="estoque" class="section">
            <h1 style="font-size: 2rem; margin-bottom: 2rem; color: #f97316;">üìã Estoque</h1>
            <button class="btn btn-primary" onclick="abrirModal('modalIngrediente')" style="margin-bottom: 1.5rem;">+ Novo Ingrediente</button>
            <table class="table">
                <thead>
                    <tr>
                        <th>Ingrediente</th>
                        <th>Estoque</th>
                        <th>Pre√ßo Unit.</th>
                        <th>Total</th>
                        <th>Alerta</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="tabelaEstoque">
                    <tr><td colspan="6" style="text-align: center; color: #94a3b8;">Nenhum ingrediente cadastrado</td></tr>
                </tbody>
            </table>
        </div>

        <!-- DESPESAS -->
        <div id="despesas" class="section">
            <h1 style="font-size: 2rem; margin-bottom: 2rem; color: #f97316;">üí∏ Despesas</h1>
            <button class="btn btn-primary" onclick="abrirModal('modalDespesa')" style="margin-bottom: 1.5rem;">+ Nova Despesa</button>
            <button class="btn btn-primary" onclick="abrirModal('modalDesperdicio')" style="margin-bottom: 1.5rem;">+ Registrar Desperd√≠cio</button>
            <table class="table">
                <thead>
                    <tr>
                        <th>Descri√ß√£o</th>
                        <th>Categoria</th>
                        <th>Valor</th>
                        <th>Data</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="tabelaDespesas">
                    <tr><td colspan="5" style="text-align: center; color: #94a3b8;">Nenhuma despesa registrada</td></tr>
                </tbody>
            </table>
        </div>

        <!-- RELAT√ìRIOS -->
        <div id="relatorios" class="section">
            <h1 style="font-size: 2rem; margin-bottom: 2rem; color: #f97316;">üìä Relat√≥rios</h1>
            <div style="margin-bottom: 2rem;">
                <button class="btn btn-primary" onclick="exportarPDF()" style="margin-right: 1rem;">‚¨áÔ∏è Salvar como PDF</button>
                <button class="btn btn-primary" onclick="exportarExcel()">üìä Exportar para Excel</button>
            </div>
            <div class="grid-3" style="margin-bottom: 2rem;">
                <div class="summary-card">
                    <div class="summary-label">Faturamento</div>
                    <div class="summary-value" id="relFaturamento">R$ 0,00</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">CMV</div>
                    <div class="summary-value" id="relCMV">R$ 0,00</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">Lucro Bruto</div>
                    <div class="summary-value" id="relLucroBruto">R$ 0,00</div>
                </div>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Cliente</th>
                        <th>Produtos</th>
                        <th>Total</th>
                        <th>Custo</th>
                        <th>Lucro</th>
                        <th>M√©todo</th>
                        <th>Data</th>
                    </tr>
                </thead>
                <tbody id="tabelaRelatorios">
                    <tr><td colspan="8" style="text-align: center; color: #94a3b8;">Nenhuma venda</td></tr>
                </tbody>
            </table>
        </div>

        <!-- CONFIGURA√á√ïES -->
        <div id="config" class="section">
            <h1 style="font-size: 2rem; margin-bottom: 2rem; color: #f97316;">‚öôÔ∏è Configura√ß√µes</h1>
            <div class="card" style="max-width: 500px;">
                <h2 style="margin-bottom: 1.5rem; color: #f97316;">Taxas de Pagamento</h2>
                <div class="form-group">
                    <label class="form-label">Taxa de D√©bito (%)</label>
                    <input type="number" class="form-input" id="taxaDebito" value="1.5" onchange="app.config.taxaDebito = parseFloat(this.value); salvarDados()">
                </div>
                <div class="form-group">
                    <label class="form-label">Taxa de Cr√©dito (%)</label>
                    <input type="number" class="form-input" id="taxaCredito" value="2.5" onchange="app.config.taxaCredito = parseFloat(this.value); salvarDados()">
                </div>
                <button class="btn btn-success" onclick="salvarDados()" style="width: 100%;">Salvar</button>
            </div>
        </div>
    </div>

    <!-- MODAIS -->
    <!-- Modal Produto -->
    <div id="modalProduto" class="modal">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <div class="modal-header">Novo Produto</div>
                <button class="btn btn-secondary" onclick="fecharModal('modalProduto')">√ó</button>
            </div>
            <div class="form-group">
                <label class="form-label">Nome</label>
                <input type="text" class="form-input" id="produtoNome" placeholder="Ex: Hamburguer Cl√°ssico">
            </div>
            <div class="form-group">
                <label class="form-label">Pre√ßo (R$)</label>
                <input type="number" class="form-input" id="produtoPreco" placeholder="25.00" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">Custo (R$)</label>
                <input type="number" class="form-input" id="produtoCusto" placeholder="8.00" step="0.01">
            </div>
            <div style="display: flex; gap: 1rem;">
                <button class="btn btn-secondary" onclick="fecharModal('modalProduto')" style="flex: 1;">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarProduto()" style="flex: 1;">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Ingrediente -->
    <div id="modalIngrediente" class="modal">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <div class="modal-header">Novo Ingrediente</div>
                <button class="btn btn-secondary" onclick="fecharModal('modalIngrediente')">√ó</button>
            </div>
            <div class="form-group">
                <label class="form-label">Nome</label>
                <input type="text" class="form-input" id="ingredienteNome" placeholder="Ex: Carne Mo√≠da">
            </div>
            <div class="form-group">
                <label class="form-label">Quantidade</label>
                <input type="number" class="form-input" id="ingredienteQtd" placeholder="1000" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">Unidade</label>
                <input type="text" class="form-input" id="ingredienteUnidade" placeholder="g, un, L, etc">
            </div>
            <div class="form-group">
                <label class="form-label">Pre√ßo Unit√°rio (R$)</label>
                <input type="number" class="form-input" id="ingredientePreco" placeholder="0.05" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">Alerta Estoque Baixo</label>
                <input type="number" class="form-input" id="ingredienteAlerta" placeholder="100">
            </div>
            <div style="display: flex; gap: 1rem;">
                <button class="btn btn-secondary" onclick="fecharModal('modalIngrediente')" style="flex: 1;">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarIngrediente()" style="flex: 1;">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Despesa -->
    <div id="modalDespesa" class="modal">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <div class="modal-header">Nova Despesa</div>
                <button class="btn btn-secondary" onclick="fecharModal('modalDespesa')">√ó</button>
            </div>
            <div class="form-group">
                <label class="form-label">Descri√ß√£o</label>
                <input type="text" class="form-input" id="despesaDesc" placeholder="Ex: Aluguel do Ponto">
            </div>
            <div class="form-group">
                <label class="form-label">Categoria</label>
                <select class="form-input" id="despesaCat">
                    <option>Aluguel</option>
                    <option>Combust√≠vel</option>
                    <option>Manuten√ß√£o</option>
                    <option>Utens√≠lios</option>
                    <option>Outros</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Valor (R$)</label>
                <input type="number" class="form-input" id="despesaValor" placeholder="0.00" step="0.01">
            </div>
            <div style="display: flex; gap: 1rem;">
                <button class="btn btn-secondary" onclick="fecharModal('modalDespesa')" style="flex: 1;">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarDespesa()" style="flex: 1;">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Desperd√≠cio -->
    <div id="modalDesperdicio" class="modal">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <div class="modal-header">Registrar Desperd√≠cio</div>
                <button class="btn btn-secondary" onclick="fecharModal('modalDesperdicio')">√ó</button>
            </div>
            <div class="form-group">
                <label class="form-label">Ingrediente</label>
                <select class="form-input" id="desperdicioIngrediente">
                    <option>Selecione um ingrediente</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Quantidade</label>
                <input type="number" class="form-input" id="desperdicioQtd" placeholder="100" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">Motivo</label>
                <input type="text" class="form-input" id="desperdicioMotivo" placeholder="Ex: Vencimento, Dano, etc">
            </div>
            <div style="display: flex; gap: 1rem;">
                <button class="btn btn-secondary" onclick="fecharModal('modalDesperdicio')" style="flex: 1;">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarDesperdicio()" style="flex: 1;">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Combo -->
    <div id="modalCombo" class="modal">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <div class="modal-header">Novo Combo</div>
                <button class="btn btn-secondary" onclick="fecharModal('modalCombo')">√ó</button>
            </div>
            <div class="form-group">
                <label class="form-label">Nome</label>
                <input type="text" class="form-input" id="comboNome" placeholder="Ex: Combo Executivo">
            </div>
            <div class="form-group">
                <label class="form-label">Pre√ßo (R$)</label>
                <input type="number" class="form-input" id="comboPreco" placeholder="45.00" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">Produtos</label>
                <div id="comboProdutos" class="checkbox-group">
                    <!-- Preenchido por JS -->
                </div>
            </div>
            <div style="display: flex; gap: 1rem;">
                <button class="btn btn-secondary" onclick="fecharModal('modalCombo')" style="flex: 1;">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarCombo()" style="flex: 1;">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Cliente -->
    <div id="modalCliente" class="modal">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <div class="modal-header">Novo Cliente</div>
                <button class="btn btn-secondary" onclick="fecharModal('modalCliente')">√ó</button>
            </div>
            <div class="form-group">
                <label class="form-label">Nome</label>
                <input type="text" class="form-input" id="clienteNome" placeholder="Ex: Jo√£o Silva">
            </div>
            <div class="form-group">
                <label class="form-label">WhatsApp</label>
                <input type="text" class="form-input" id="clienteWhatsapp" placeholder="11999999999">
            </div>
            <div style="display: flex; gap: 1rem;">
                <button class="btn btn-secondary" onclick="fecharModal('modalCliente')" style="flex: 1;">Cancelar</button>
                <button class="btn btn-primary" onclick="salvarCliente()" style="flex: 1;">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Pagamento -->
    <div id="modalPagamento" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header" style="margin-bottom: 2rem;">M√©todo de Pagamento</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                <button class="btn btn-success" onclick="processarPagamento('Dinheiro')" style="padding: 2rem;">üíµ Dinheiro</button>
                <button class="btn btn-primary" onclick="processarPagamento('D√©bito')" style="padding: 2rem;">üèß D√©bito</button>
                <button class="btn btn-primary" onclick="processarPagamento('Cr√©dito')" style="padding: 2rem;">üí≥ Cr√©dito</button>
                <button class="btn btn-primary" onclick="processarPagamento('PIX')" style="padding: 2rem;">üì± PIX</button>
            </div>
            <button class="btn btn-secondary" onclick="fecharModal('modalPagamento')" style="width: 100%;">Cancelar</button>
        </div>
    </div>

    <!-- Modal Sucesso -->
    <div id="modalSucesso" class="modal">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <div style="font-size: 3rem; margin-bottom: 1rem;">‚úì</div>
            <div class="modal-header" style="margin-bottom: 1rem;">Venda Realizada!</div>
            <div style="margin-bottom: 1rem;">
                <div style="color: #94a3b8; margin-bottom: 0.5rem;">N√∫mero do Pedido:</div>
                <div style="font-size: 1.5rem; font-weight: bold; color: #f97316;" id="numeroPedidoSucesso">#1</div>
            </div>
            <div style="margin-bottom: 2rem;">
                <div style="color: #94a3b8; margin-bottom: 0.5rem;">Total:</div>
                <div style="font-size: 1.5rem; font-weight: bold; color: #22c55e;" id="totalSucesso">R$ 0,00</div>
            </div>
            <button class="btn btn-success" onclick="fecharModal('modalSucesso'); mostrarSecao('vendas')" style="width: 100%;">OK</button>
        </div>
    </div>

    <script>
        // DADOS GLOBAIS
        const app = {
            vendas: {
                cliente: '',
                whatsapp: '',
                tipoPedido: 'Local',
                origem: 'Venda Local',
                itens: [],
                metodo: ''
            },
            config: {
                taxaDebito: 1.5,
                taxaCredito: 2.5
            }
        };

        let dados = {
            produtos: [
                { id: 1, nome: 'üçî Hamburguer Cl√°ssico', preco: 25.00, custo: 8.00, adicionais: [1, 2] },
                { id: 2, nome: 'üçî Hamburguer Especial', preco: 35.00, custo: 12.00, adicionais: [1, 2, 3, 4] },
                { id: 3, nome: 'üç¢ Churrasc√£o de Alcatra', preco: 15.00, custo: 6.45, adicionais: [1, 2] }
            ],
            adicionais: [
                { id: 1, nome: 'Maionese Temperada', preco: 2.00 },
                { id: 2, nome: 'Farofa', preco: 1.50 },
                { id: 3, nome: 'Queijo Extra', preco: 3.00 },
                { id: 4, nome: 'Bacon Extra', preco: 4.00 },
                { id: 5, nome: 'Sem Cebola', preco: 0.00 }
            ],
            vendas: [],
            pedidos: [],
            clientes: [],
            ingredientes: [],
            despesas: [],
            combos: [],
            desperdicio: []
        };

        // CARREGAR DADOS
        function carregarDados() {
            const saved = localStorage.getItem('foodTruckData');
            if (saved) {
                dados = JSON.parse(saved);
            }
            const configSaved = localStorage.getItem('foodTruckConfig');
            if (configSaved) {
                app.config = JSON.parse(configSaved);
                document.getElementById('taxaDebito').value = app.config.taxaDebito;
                document.getElementById('taxaCredito').value = app.config.taxaCredito;
            }
            atualizarUI();
        }

        // SALVAR DADOS
        function salvarDados() {
            localStorage.setItem('foodTruckData', JSON.stringify(dados));
            localStorage.setItem('foodTruckConfig', JSON.stringify(app.config));
            atualizarUI();
        }

        // MOSTRAR SE√á√ÉO
        function mostrarSecao(secao) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(secao).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            atualizarUI();
        }

        // MOSTRAR SUB-SE√á√ÉO
        function mostrarSubSecao(pai, sub) {
            document.querySelectorAll(`#${pai} .section`).forEach(s => s.classList.remove('active'));
            document.getElementById(sub).classList.add('active');
            event.target.parentElement.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
        }

        // ABRIR/FECHAR MODAL
        function abrirModal(id) {
            document.getElementById(id).classList.add('active');
        }

        function fecharModal(id) {
            document.getElementById(id).classList.remove('active');
        }

        // ADICIONAR PRODUTO AO CARRINHO
        function adicionarAoCarrinho(produtoId) {
            const produto = dados.produtos.find(p => p.id === produtoId);
            if (!produto) return;

            app.vendas.itens.push({
                id: produtoId,
                nome: produto.nome,
                preco: produto.preco,
                custo: produto.custo,
                adicionais: [],
                observacoes: ''
            });

            atualizarCarrinho();
        }

        // ATUALIZAR CARRINHO
        function atualizarCarrinho() {
            const container = document.getElementById('itensCarrinho');
            
            if (app.vendas.itens.length === 0) {
                container.innerHTML = '<p style="color: #94a3b8;">Carrinho vazio</p>';
                document.getElementById('subtotal').textContent = 'R$ 0,00';
                document.getElementById('taxa').textContent = 'R$ 0,00';
                document.getElementById('totalCarrinho').textContent = 'R$ 0,00';
                return;
            }

            let html = '';
            let subtotal = 0;

            app.vendas.itens.forEach((item, idx) => {
                let precoItem = item.preco;
                let adicionaisHtml = '';
                
                if (item.adicionais && item.adicionais.length > 0) {
                    item.adicionais.forEach(adId => {
                        const ad = dados.adicionais.find(a => a.id === adId);
                        if (ad) {
                            precoItem += ad.preco;
                            adicionaisHtml += `<span class="additional-tag">${ad.nome}</span>`;
                        }
                    });
                }

                subtotal += precoItem;

                html += `
                    <div style="background: #0f172a; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; border-left: 3px solid #f97316;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                            <div>
                                <div style="font-weight: bold;">${item.nome}</div>
                                <div style="color: #94a3b8; font-size: 0.875rem;">${adicionaisHtml}</div>
                            </div>
                            <button class="btn btn-danger" onclick="removerDoCarrinho(${idx})" style="padding: 0.25rem 0.75rem;">‚úï</button>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="color: #94a3b8;">
                                <input type="number" value="1" min="1" style="width: 50px; padding: 0.25rem; background: #1e293b; border: 1px solid #334155; color: #e2e8f0; border-radius: 0.25rem;" onchange="app.vendas.itens[${idx}].quantidade = parseInt(this.value); atualizarCarrinho()">
                            </div>
                            <div style="font-weight: bold; color: #f97316;">R$ ${precoItem.toFixed(2)}</div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;

            let taxa = 0;
            if (app.vendas.metodo === 'D√©bito') {
                taxa = subtotal * (app.config.taxaDebito / 100);
            } else if (app.vendas.metodo === 'Cr√©dito') {
                taxa = subtotal * (app.config.taxaCredito / 100);
            }

            const total = subtotal + taxa;

            document.getElementById('subtotal').textContent = `R$ ${subtotal.toFixed(2)}`;
            document.getElementById('taxa').textContent = `R$ ${taxa.toFixed(2)}`;
            document.getElementById('totalCarrinho').textContent = `R$ ${total.toFixed(2)}`;
        }

        // REMOVER DO CARRINHO
        function removerDoCarrinho(idx) {
            app.vendas.itens.splice(idx, 1);
            atualizarCarrinho();
        }

        // FINALIZAR VENDA
        function finalizarVenda() {
            if (app.vendas.itens.length === 0) {
                alert('Adicione produtos ao carrinho');
                return;
            }
            if (!app.vendas.cliente) {
                alert('Informe o nome do cliente');
                return;
            }
            abrirModal('modalPagamento');
        }

        // PROCESSAR PAGAMENTO
        function processarPagamento(metodo) {
            fecharModal('modalPagamento');
            app.vendas.metodo = metodo;

            const subtotal = app.vendas.itens.reduce((sum, item) => {
                let preco = item.preco;
                if (item.adicionais) {
                    item.adicionais.forEach(adId => {
                        const ad = dados.adicionais.find(a => a.id === adId);
                        if (ad) preco += ad.preco;
                    });
                }
                return sum + preco;
            }, 0);

            let taxa = 0;
            if (metodo === 'D√©bito') {
                taxa = subtotal * (app.config.taxaDebito / 100);
            } else if (metodo === 'Cr√©dito') {
                taxa = subtotal * (app.config.taxaCredito / 100);
            }

            const total = subtotal + taxa;

            const venda = {
                id: dados.vendas.length + 1,
                numero: dados.pedidos.length + 1,
                cliente: app.vendas.cliente,
                whatsapp: app.vendas.whatsapp,
                tipoPedido: app.vendas.tipoPedido,
                origem: app.vendas.origem,
                itens: [...app.vendas.itens],
                subtotal: subtotal,
                taxa: taxa,
                total: total,
                metodo: metodo,
                data: new Date().toLocaleDateString('pt-BR'),
                hora: new Date().toLocaleTimeString('pt-BR'),
                status: 'pendente'
            };

            dados.vendas.push(venda);

            const pedido = {
                id: venda.numero,
                numero: venda.numero,
                cliente: venda.cliente,
                whatsapp: venda.whatsapp,
                tipoPedido: venda.tipoPedido,
                itens: venda.itens,
                status: 'pendente',
                dataHora: new Date(),
                tempoInicio: new Date()
            };

            dados.pedidos.push(pedido);

            document.getElementById('numeroPedidoSucesso').textContent = `#${venda.numero}`;
            document.getElementById('totalSucesso').textContent = `R$ ${total.toFixed(2)}`;

            abrirModal('modalSucesso');

            app.vendas = {
                cliente: '',
                whatsapp: '',
                tipoPedido: 'Local',
                origem: 'Venda Local',
                itens: [],
                metodo: ''
            };

            salvarDados();
        }

        // SALVAR PRODUTO
        function salvarProduto() {
            const nome = document.getElementById('produtoNome').value;
            const preco = parseFloat(document.getElementById('produtoPreco').value);
            const custo = parseFloat(document.getElementById('produtoCusto').value);

            if (!nome || !preco || !custo) {
                alert('Preencha todos os campos');
                return;
            }

            dados.produtos.push({
                id: dados.produtos.length + 1,
                nome: nome,
                preco: preco,
                custo: custo,
                adicionais: []
            });

            document.getElementById('produtoNome').value = '';
            document.getElementById('produtoPreco').value = '';
            document.getElementById('produtoCusto').value = '';

            fecharModal('modalProduto');
            salvarDados();
        }

        // SALVAR INGREDIENTE
        function salvarIngrediente() {
            const nome = document.getElementById('ingredienteNome').value;
            const qtd = parseFloat(document.getElementById('ingredienteQtd').value);
            const unidade = document.getElementById('ingredienteUnidade').value;
            const preco = parseFloat(document.getElementById('ingredientePreco').value);
            const alerta = parseFloat(document.getElementById('ingredienteAlerta').value);

            if (!nome || !qtd || !unidade || !preco) {
                alert('Preencha todos os campos');
                return;
            }

            dados.ingredientes.push({
                id: dados.ingredientes.length + 1,
                nome: nome,
                quantidade: qtd,
                unidade: unidade,
                preco: preco,
                alerta: alerta || qtd * 0.2
            });

            document.getElementById('ingredienteNome').value = '';
            document.getElementById('ingredienteQtd').value = '';
            document.getElementById('ingredienteUnidade').value = '';
            document.getElementById('ingredientePreco').value = '';
            document.getElementById('ingredienteAlerta').value = '';

            fecharModal('modalIngrediente');
            salvarDados();
        }

        // SALVAR DESPESA
        function salvarDespesa() {
            const desc = document.getElementById('despesaDesc').value;
            const cat = document.getElementById('despesaCat').value;
            const valor = parseFloat(document.getElementById('despesaValor').value);

            if (!desc || !valor) {
                alert('Preencha todos os campos');
                return;
            }

            dados.despesas.push({
                id: dados.despesas.length + 1,
                descricao: desc,
                categoria: cat,
                valor: valor,
                data: new Date().toLocaleDateString('pt-BR')
            });

            document.getElementById('despesaDesc').value = '';
            document.getElementById('despesaValor').value = '';

            fecharModal('modalDespesa');
            salvarDados();
        }

        // SALVAR DESPERD√çCIO
        function salvarDesperdicio() {
            const ing = document.getElementById('desperdicioIngrediente').value;
            const qtd = parseFloat(document.getElementById('desperdicioQtd').value);
            const motivo = document.getElementById('desperdicioMotivo').value;

            if (!ing || !qtd || !motivo) {
                alert('Preencha todos os campos');
                return;
            }

            dados.desperdicio.push({
                id: dados.desperdicio.length + 1,
                ingrediente: ing,
                quantidade: qtd,
                motivo: motivo,
                data: new Date().toLocaleDateString('pt-BR')
            });

            document.getElementById('desperdicioIngrediente').value = '';
            document.getElementById('desperdicioQtd').value = '';
            document.getElementById('desperdicioMotivo').value = '';

            fecharModal('modalDesperdicio');
            salvarDados();
        }

        // SALVAR COMBO
        function salvarCombo() {
            const nome = document.getElementById('comboNome').value;
            const preco = parseFloat(document.getElementById('comboPreco').value);

            if (!nome || !preco) {
                alert('Preencha todos os campos');
                return;
            }

            dados.combos.push({
                id: dados.combos.length + 1,
                nome: nome,
                preco: preco
            });

            document.getElementById('comboNome').value = '';
            document.getElementById('comboPreco').value = '';

            fecharModal('modalCombo');
            salvarDados();
        }

        // SALVAR CLIENTE
        function salvarCliente() {
            const nome = document.getElementById('clienteNome').value;
            const whatsapp = document.getElementById('clienteWhatsapp').value;

            if (!nome) {
                alert('Informe o nome');
                return;
            }

            dados.clientes.push({
                id: dados.clientes.length + 1,
                nome: nome,
                whatsapp: whatsapp || ''
            });

            document.getElementById('clienteNome').value = '';
            document.getElementById('clienteWhatsapp').value = '';

            fecharModal('modalCliente');
            salvarDados();
        }

        // MARCAR PEDIDO COMO PRONTO
        function marcarPronto(pedidoId) {
            const pedido = dados.pedidos.find(p => p.numero === pedidoId);
            if (pedido) {
                pedido.status = 'pronto';
                salvarDados();
            }
        }

        // CANCELAR PEDIDO
        function cancelarPedido(pedidoId) {
            const pedido = dados.pedidos.find(p => p.numero === pedidoId);
            if (pedido) {
                pedido.status = 'cancelado';
                // Remover da venda
                dados.vendas = dados.vendas.filter(v => v.numero !== pedidoId);
                salvarDados();
            }
        }

        // ATUALIZAR UI
        function atualizarUI() {
            // DASHBOARD
            const vendas = dados.vendas.filter(v => v.data === new Date().toLocaleDateString('pt-BR'));
            const faturamento = vendas.reduce((sum, v) => sum + v.total, 0);
            const custos = vendas.reduce((sum, v) => {
                return sum + v.itens.reduce((itemSum, item) => itemSum + item.custo, 0);
            }, 0);
            const lucro = faturamento - custos;

            document.getElementById('faturamento').textContent = `R$ ${faturamento.toFixed(2)}`;
            document.getElementById('lucro').textContent = `R$ ${lucro.toFixed(2)}`;
            document.getElementById('pedidosHoje').textContent = vendas.length;

            // DASHBOARD - HIST√ìRICO
            let historicoHtml = '';
            vendas.forEach(v => {
                historicoHtml += `
                    <tr>
                        <td>#${v.numero}</td>
                        <td>${v.cliente}</td>
                        <td>${v.itens.map(i => i.nome).join(', ')}</td>
                        <td>R$ ${v.total.toFixed(2)}</td>
                        <td>${v.metodo}</td>
                        <td>${v.hora}</td>
                    </tr>
                `;
            });
            document.getElementById('dashboardHistorico').innerHTML = historicoHtml || '<tr><td colspan="6" style="text-align: center; color: #94a3b8;">Nenhuma venda realizada</td></tr>';

            // DASHBOARD - PARA ENTREGA
            const prontos = dados.pedidos.filter(p => p.status === 'pronto');
            let entregaHtml = '';
            prontos.forEach(p => {
                entregaHtml += `
                    <div class="card" style="border-left: 5px solid #22c55e;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: #f97316;">#${p.numero}</div>
                            <span class="badge badge-green">PRONTO</span>
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <div style="color: #94a3b8; font-size: 0.875rem;">Cliente:</div>
                            <div style="font-weight: bold;">${p.cliente}</div>
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <div style="color: #94a3b8; font-size: 0.875rem;">Produtos:</div>
                            <div>${p.itens.map(i => i.nome).join(', ')}</div>
                        </div>
                    </div>
                `;
            });
            document.getElementById('dashboardEntrega').innerHTML = entregaHtml || '<p style="color: #94a3b8;">Nenhum pedido pronto para entrega</p>';

            // PRODUTOS
            let produtosHtml = '';
            dados.produtos.forEach(p => {
                const lucro = p.preco - p.custo;
                produtosHtml += `
                    <tr>
                        <td>${p.nome}</td>
                        <td>R$ ${p.preco.toFixed(2)}</td>
                        <td>R$ ${p.custo.toFixed(2)}</td>
                        <td style="color: #22c55e;">R$ ${lucro.toFixed(2)}</td>
                        <td>
                            <button class="btn btn-danger" onclick="deletarProduto(${p.id})" style="padding: 0.25rem 0.75rem;">üóëÔ∏è</button>
                        </td>
                    </tr>
                `;
            });
            document.getElementById('tabelaProdutos').innerHTML = produtosHtml || '<tr><td colspan="5" style="text-align: center; color: #94a3b8;">Nenhum produto cadastrado</td></tr>';

            // ESTOQUE
            let estoqueHtml = '';
            dados.ingredientes.forEach(i => {
                const total = i.quantidade * i.preco;
                const alerta = i.quantidade < i.alerta ? '<span class="badge badge-red">BAIXO</span>' : '';
                estoqueHtml += `
                    <tr>
                        <td>${i.nome}</td>
                        <td>${i.quantidade} ${i.unidade}</td>
                        <td>R$ ${i.preco.toFixed(2)}</td>
                        <td>R$ ${total.toFixed(2)}</td>
                        <td>${alerta}</td>
                        <td>
                            <button class="btn btn-danger" onclick="deletarIngrediente(${i.id})" style="padding: 0.25rem 0.75rem;">üóëÔ∏è</button>
                        </td>
                    </tr>
                `;
            });
            document.getElementById('tabelaEstoque').innerHTML = estoqueHtml || '<tr><td colspan="6" style="text-align: center; color: #94a3b8;">Nenhum ingrediente cadastrado</td></tr>';

            // DESPESAS
            let despesasHtml = '';
            dados.despesas.forEach(d => {
                despesasHtml += `
                    <tr>
                        <td>${d.descricao}</td>
                        <td><span class="badge badge-orange">${d.categoria}</span></td>
                        <td>R$ ${d.valor.toFixed(2)}</td>
                        <td>${d.data}</td>
                        <td>
                            <button class="btn btn-danger" onclick="deletarDespesa(${d.id})" style="padding: 0.25rem 0.75rem;">üóëÔ∏è</button>
                        </td>
                    </tr>
                `;
            });
            document.getElementById('tabelaDespesas').innerHTML = despesasHtml || '<tr><td colspan="5" style="text-align: center; color: #94a3b8;">Nenhuma despesa registrada</td></tr>';

            // CLIENTES
            let clientesHtml = '';
            dados.clientes.forEach(c => {
                const compras = dados.vendas.filter(v => v.cliente === c.nome).length;
                const total = dados.vendas.filter(v => v.cliente === c.nome).reduce((sum, v) => sum + v.total, 0);
                clientesHtml += `
                    <tr>
                        <td>${c.nome}</td>
                        <td>${c.whatsapp || '-'}</td>
                        <td>${compras}</td>
                        <td>R$ ${total.toFixed(2)}</td>
                        <td>
                            <button class="btn btn-danger" onclick="deletarCliente(${c.id})" style="padding: 0.25rem 0.75rem;">üóëÔ∏è</button>
                        </td>
                    </tr>
                `;
            });
            document.getElementById('tabelaClientes').innerHTML = clientesHtml || '<tr><td colspan="5" style="text-align: center; color: #94a3b8;">Nenhum cliente cadastrado</td></tr>';

            // COMBOS
            let combosHtml = '';
            dados.combos.forEach(c => {
                combosHtml += `
                    <tr>
                        <td>${c.nome}</td>
                        <td>-</td>
                        <td>R$ ${c.preco.toFixed(2)}</td>
                        <td>
                            <button class="btn btn-danger" onclick="deletarCombo(${c.id})" style="padding: 0.25rem 0.75rem;">üóëÔ∏è</button>
                        </td>
                    </tr>
                `;
            });
            document.getElementById('tabelaCombos').innerHTML = combosHtml || '<tr><td colspan="4" style="text-align: center; color: #94a3b8;">Nenhum combo cadastrado</td></tr>';

            // PRODUTOS NA TELA DE VENDAS
            let produtosVendas = '';
            dados.produtos.forEach(p => {
                produtosVendas += `
                    <div class="card product-card" onclick="adicionarAoCarrinho(${p.id})">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üçî</div>
                        <div style="font-weight: bold; margin-bottom: 0.5rem;">${p.nome}</div>
                        <div style="color: #f97316; font-weight: bold;">R$ ${p.preco.toFixed(2)}</div>
                        <div style="color: #94a3b8; font-size: 0.875rem;">Lucro R$ ${(p.preco - p.custo).toFixed(2)}</div>
                    </div>
                `;
            });
            document.getElementById('gridProdutos').innerHTML = produtosVendas;

            // COZINHA
            const pendentes = dados.pedidos.filter(p => p.status === 'pendente');
            document.getElementById('contadorPendentes').textContent = pendentes.length;

            let cozinhaHtml = '';
            pendentes.forEach(p => {
                const tempo = new Date() - p.tempoInicio;
                const minutos = Math.floor(tempo / 60000);
                const segundos = Math.floor((tempo % 60000) / 1000);
                const timerClass = minutos > 5 ? 'danger' : minutos > 3 ? 'warning' : '';

                let itensHtml = '';
                p.itens.forEach(item => {
                    let adicionaisHtml = '';
                    if (item.adicionais && item.adicionais.length > 0) {
                        item.adicionais.forEach(adId => {
                            const ad = dados.adicionais.find(a => a.id === adId);
                            if (ad) adicionaisHtml += `<span class="additional-tag">${ad.nome}</span>`;
                        });
                    }
                    itensHtml += `
                        <div style="background: #0f172a; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 0.5rem;">
                            <div style="font-weight: bold; margin-bottom: 0.25rem;">${item.nome}</div>
                            <div style="color: #94a3b8; font-size: 0.875rem;">${adicionaisHtml}</div>
                        </div>
                    `;
                });

                cozinhaHtml += `
                    <div class="card product-card pending" style="border-left: 5px solid #f97316;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                            <div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: #f97316;">#${p.numero}</div>
                                <div style="color: #94a3b8; font-size: 0.875rem;">${p.cliente}</div>
                            </div>
                            <span class="badge badge-orange">${p.tipoPedido}</span>
                        </div>
                        <div class="timer ${timerClass}" style="margin-bottom: 1rem;">‚è±Ô∏è ${minutos.toString().padStart(2, '0')}:${segundos.toString().padStart(2, '0')}</div>
                        <div style="margin-bottom: 1rem;">
                            ${itensHtml}
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-success" onclick="marcarPronto(${p.numero})" style="flex: 1;">‚úì PRONTO</button>
                            <button class="btn btn-danger" onclick="cancelarPedido(${p.numero})" style="flex: 1;">üóëÔ∏è Cancelar</button>
                        </div>
                    </div>
                `;
            });
            document.getElementById('gridCozinha').innerHTML = cozinhaHtml || '<p style="color: #94a3b8;">Nenhum pedido pendente</p>';

            // HIST√ìRICO DE VENDAS
            let historicoVendasHtml = '';
            dados.vendas.forEach(v => {
                historicoVendasHtml += `
                    <tr>
                        <td>#${v.numero}</td>
                        <td>${v.cliente}</td>
                        <td>${v.itens.map(i => i.nome).join(', ')}</td>
                        <td>R$ ${v.total.toFixed(2)}</td>
                        <td>${v.metodo}</td>
                        <td><span class="badge badge-green">Conclu√≠do</span></td>
                        <td>${v.hora}</td>
                    </tr>
                `;
            });
            document.getElementById('tabelaHistoricoVendas').innerHTML = historicoVendasHtml || '<tr><td colspan="7" style="text-align: center; color: #94a3b8;">Nenhuma venda realizada</td></tr>';

            // RELAT√ìRIOS
            const totalFaturamento = dados.vendas.reduce((sum, v) => sum + v.total, 0);
            const totalCusto = dados.vendas.reduce((sum, v) => {
                return sum + v.itens.reduce((itemSum, item) => itemSum + item.custo, 0);
            }, 0);
            const lucroTotal = totalFaturamento - totalCusto;

            document.getElementById('relFaturamento').textContent = `R$ ${totalFaturamento.toFixed(2)}`;
            document.getElementById('relCMV').textContent = `R$ ${totalCusto.toFixed(2)}`;
            document.getElementById('relLucroBruto').textContent = `R$ ${lucroTotal.toFixed(2)}`;

            let relatorioHtml = '';
            dados.vendas.forEach(v => {
                const custoPedido = v.itens.reduce((sum, item) => sum + item.custo, 0);
                const lucroPedido = v.total - custoPedido;
                relatorioHtml += `
                    <tr>
                        <td>#${v.numero}</td>
                        <td>${v.cliente}</td>
                        <td>${v.itens.map(i => i.nome).join(', ')}</td>
                        <td>R$ ${v.total.toFixed(2)}</td>
                        <td>R$ ${custoPedido.toFixed(2)}</td>
                        <td style="color: #22c55e;">R$ ${lucroPedido.toFixed(2)}</td>
                        <td>${v.metodo}</td>
                        <td>${v.data}</td>
                    </tr>
                `;
            });
            document.getElementById('tabelaRelatorios').innerHTML = relatorioHtml || '<tr><td colspan="8" style="text-align: center; color: #94a3b8;">Nenhuma venda</td></tr>';

            // ATUALIZAR CRON√îMETRO
            setInterval(() => {
                const pendentes = dados.pedidos.filter(p => p.status === 'pendente');
                pendentes.forEach((p, idx) => {
                    const tempo = new Date() - p.tempoInicio;
                    const minutos = Math.floor(tempo / 60000);
                    const segundos = Math.floor((tempo % 60000) / 1000);
                    const timers = document.querySelectorAll('.timer');
                    if (timers[idx]) {
                        timers[idx].textContent = `‚è±Ô∏è ${minutos.toString().padStart(2, '0')}:${segundos.toString().padStart(2, '0')}`;
                        timers[idx].className = 'timer ' + (minutos > 5 ? 'danger' : minutos > 3 ? 'warning' : '');
                    }
                });
            }, 1000);
        }

        // DELETAR FUN√á√ïES
        function deletarProduto(id) {
            dados.produtos = dados.produtos.filter(p => p.id !== id);
            salvarDados();
        }

        function deletarIngrediente(id) {
            dados.ingredientes = dados.ingredientes.filter(i => i.id !== id);
            salvarDados();
        }

        function deletarDespesa(id) {
            dados.despesas = dados.despesas.filter(d => d.id !== id);
            salvarDados();
        }

        function deletarCliente(id) {
            dados.clientes = dados.clientes.filter(c => c.id !== id);
            salvarDados();
        }

        function deletarCombo(id) {
            dados.combos = dados.combos.filter(c => c.id !== id);
            salvarDados();
        }

        // EXPORTAR PDF
        function exportarPDF() {
            const element = document.getElementById('tabelaRelatorios');
            const opt = {
                margin: 10,
                filename: 'relatorio-food-truck.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { orientation: 'landscape', unit: 'mm', format: 'a4' }
            };
            html2pdf().set(opt).from(element).save();
        }

        // EXPORTAR EXCEL
        function exportarExcel() {
            let csv = 'N√∫mero,Cliente,Produtos,Total,Custo,Lucro,M√©todo,Data\n';
            dados.vendas.forEach(v => {
                const custoPedido = v.itens.reduce((sum, item) => sum + item.custo, 0);
                const lucroPedido = v.total - custoPedido;
                csv += `#${v.numero},"${v.cliente}","${v.itens.map(i => i.nome).join(', ')}",${v.total.toFixed(2)},${custoPedido.toFixed(2)},${lucroPedido.toFixed(2)},"${v.metodo}",${v.data}\n`;
            });
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'relatorio-food-truck.csv';
            a.click();
        }

        // INICIALIZAR
        carregarDados();
    </script>
</body>
</html>
